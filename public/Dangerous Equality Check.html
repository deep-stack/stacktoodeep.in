<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Dangerous Equality Check</title>
  <link rel="stylesheet" href="reset.css" />
  <link rel="stylesheet" href="index.css" />
  <style>
    .title {
      text-align: left;
      font-size: 2em;
      margin-bottom: 0;
    }
    .subtitle {
      text-align: left;
      font-size: 1em;
      color: #555;
      margin-top: 0;
    }
  </style>
</head>
<body>
<table class="header">
  <tr>
    <td colspan="2" class="width-auto">
      <h1 class="title">Dangerous Equality Check</h1>
    </td>
  </tr>
  <tr>
    <th class="width-min">Organization</th>
    <td class="width-auto">DeepStack Software Pvt. Ltd.</td>
  </tr>
  <tr>
    <th class="width-min">Org URL</th>
    <td class="width-auto"><a href="https://www.deepstacksoft.com">https://www.deepstacksoft.com</a></td>
  </tr>
  </tr>
</table>
<nav id="TOC" role="doc-toc">
      <h2 id="toc-title">Contents</h2>
    <ul class="incremental">
    <li><a href="#introduction"
    id="toc-introduction">Introduction</a></li>
    <li><a href="#understanding-problem"
    id="toc-understanding-problem">Understanding problem</a></li>
    <li><a href="#exploit" id="toc-exploit">Exploit</a></li>
    <li><a href="#mitigation" id="toc-mitigation">Mitigation</a></li>
    </ul>
</nav>
<nav>
<a href="index.html"><button>Back</button></a>
</nav>
<p><strong>Posted on: 2024-09-18</strong></p>
<h2 id="introduction">Introduction</h2>
<p>If a contract relies on accounting of funds, an Attacker can easily
disrupt the flow by force feeding <code>ETH</code> into the contract.
There are multiple ways a smart contract can receive Ether, One of them
is <strong>payable reveive()</strong> should be present if no then
<strong>payable fallback()</strong></p>
<p><img src="codeblock-0.png" /></p>
<h2 id="understanding-problem">Understanding problem</h2>
<p>Consider this Crowd funding contract for example</p>
<p><img src="codeblock-1.png" /></p>
<ul class="incremental">
<li><strong>require(address(this).balancer == 100 ether, “Funding not
reached”)</strong> the above contract relies on exact comparisons to the
contract’s Ether balance</li>
<li>The contract’s logic seemingly disallows direct payments and tells
to use invest function instead.</li>
</ul>
<h2 id="exploit">Exploit</h2>
<p>Force feeding Ether</p>
<p><img src="codeblock-2.png" /></p>
<ul class="incremental">
<li><strong>selfdestruct</strong> opcode sends all remaining Ether
stored in the contract to a designated address.</li>
<li>An attacke can send as little as <strong>1 wei</strong> through
<strong>selfdestruct</strong> and using above contract’s address as
target</li>
</ul>
<h2 id="mitigation">Mitigation</h2>
<p>The effects described above demonstrate that relying on precise
comparisons with the contract’s Ether balance is unreliable. The smart
contract’s logic should account for the possibility that its actual
balance may exceed the value tracked by internal accounting.</p>
  <script src="index.js"></script>
</body>
</html>
